{% extends 'base.html' %}
{% block title %}
WorkSafeCenter - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å
{% endblock %}
{% block content %}
<section style="background: transparent; box-shadow: none; padding: 0;">
  <div class="section-header" style="border-bottom: none; margin-bottom: 20px;">
    <h2 style="margin: 0;">üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å</h2>
    <div style="display: flex; gap: 10px;">
      {% if user.is_superuser %}
        <a href="{% url 'admin:auth_user_add' %}" class="button" style="background-color: #6c757d;">
          üë§ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        </a>
        <a href="{% url 'admin:auth_user_changelist' %}" class="button" style="background-color: #6c757d;">
          ‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
        </a>
      {% endif %}
    </div>
  </div>
</section>

<section>
  <h3 style="margin-top: 0; color: var(--primary-color); font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold);">
    –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã –æ—Ö—Ä–∞–Ω—ã —Ç—Ä—É–¥–∞
  </h3>
  <p style="color: #666; margin-bottom: 20px; font-size: var(--font-size-sm);">
    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ {{ today|date:"d.m.Y" }}
  </p>

  <div class="dashboard-grid">
    <div class="stat-card card-danger">
      <div class="stat-header">
        <h3>‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –º–µ–¥–æ—Å–º–æ—Ç—Ä—ã</h3>
        <span class="trend negative">‚Üì 12%</span>
      </div>
      <div class="stat-value">{{ overdue_checks_count }}</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: {% widthratio overdue_checks_count 100 100 %}%"></div>
      </div>
      <div class="stat-note">+3 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é</div>
    </div>

    <div class="stat-card card-danger">
      <div class="stat-header">
        <h3>‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∏</h3>
        <span class="trend negative">‚Üì 8%</span>
      </div>
      <div class="stat-value">{{ overdue_trainings_count }}</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: {% widthratio overdue_trainings_count 100 100 %}%"></div>
      </div>
      <div class="stat-note">+2 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é</div>
    </div>

    <div class="stat-card card-warning">
      <div class="stat-header">
        <h3>üìÖ –°–æ–±—ã—Ç–∏–π –≤ –±–ª–∏–∂–∞–π—à–∏–µ 30 –¥–Ω–µ–π</h3>
        <span class="trend positive">‚Üë 5%</span>
      </div>
      <div class="stat-value">{{ upcoming_events_count }}</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: {% widthratio upcoming_events_count 100 100 %}%"></div>
      </div>
      <div class="stat-note">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
    </div>

    <div class="stat-card card-success">
      <div class="stat-header">
        <h3>‚úÖ –ò–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –∑–∞ 30 –¥–Ω–µ–π</h3>
        <span class="trend {% if recent_incidents_count > 0 %}negative{% else %}positive{% endif %}">
          {% if recent_incidents_count > 0 %}‚Üì{% else %}‚Üë{% endif %} 100%
        </span>
      </div>
      <div class="stat-value">{{ recent_incidents_count }}</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: {% widthratio recent_incidents_count 10 100 %}%"></div>
      </div>
      <div class="stat-note">–¶–µ–ª—å: 0 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤</div>
    </div>
  </div>
</section>

<style>
  .stat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-3);
  }

  .stat-value {
    font-size: 3rem;
    font-weight: var(--font-weight-bold);
    margin: var(--space-2) 0;
    color: var(--gray-900);
    line-height: 1;
  }

  .stat-note {
    font-size: var(--font-size-sm);
    color: var(--gray-600);
    margin-top: var(--space-2);
  }

  .trend {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    padding: 2px 8px;
    border-radius: var(--radius-sm);
  }

  .trend.positive {
    background-color: var(--success-100);
    color: var(--success-700);
  }

  .trend.negative {
    background-color: var(--danger-100);
    color: var(--danger-700);
  }

  .progress-bar {
    height: 6px;
    background: var(--gray-200);
    border-radius: var(--radius-full);
    margin: var(--space-3) 0;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: currentColor;
    border-radius: var(--radius-full);
    transition: width 0.3s ease;
  }

  .quick-access-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin-top: 20px;
  }

  .quick-access-card {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 20px;
    background: white;
    border-radius: var(--radius-md);
    text-decoration: none;
    color: var(--text-color);
    box-shadow: var(--shadow-sm);
    transition: all 0.3s ease;
    border: 1px solid var(--border-color);
  }

  .quick-access-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
    border-color: var(--accent-300);
  }

  .quick-access-icon {
    width: 50px;
    height: 50px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    color: white;
    flex-shrink: 0;
  }

  .quick-access-content h4 {
    margin: 0 0 5px 0;
    font-size: var(--font-size-lg);
    color: var(--primary-color);
  }

  .quick-access-content p {
    margin: 0;
    font-size: var(--font-size-sm);
    color: var(--gray-600);
  }
</style>
{% endblock %}