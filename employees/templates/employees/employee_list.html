{% extends 'base.html' %}
{% block title %}WorkSafeCenter - –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏{% endblock %}

{% block content %}
<section>
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2>–†–µ–µ—Å—Ç—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h2>
    <a href="{% url 'employees:employee_create' %}" class="button"> + –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
  </div>

  <form method="get" action="{% url 'employees:employee_list' %}" class="filter-toolbar">
      <input
          type="text"
          name="search_query"
          placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —Ñ–∞–º–∏–ª–∏–∏..."
          value="{{ search_query }}"
      >
      <select name="department">
        <option value="">üè¢ –í—Å–µ –æ—Ç–¥–µ–ª—ã</option>
        {% for dept in departments %}
        <option value="{{ dept.pk }}" {% if dept.pk|stringformat:"s" == selected_department %}selected{% endif %}>
          {{ dept.name }}
        </option>
        {% endfor %}
      </select>

      <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
      <a href="{% url 'employees:employee_list' %}" style="color: #666; margin-left: 10px; font-size: 0.9em;">–°–±—Ä–æ—Å–∏—Ç—å</a>
  </form>

  {% if employees %}
  <table>
    <thead>
    <tr>
      <th>–§–ò–û</th>
      <th>–î–æ–ª–∂–Ω–æ—Å—Ç—å / –û—Ç–¥–µ–ª</th>
      <th>–°—Ç–∞—Ç—É—Å</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
    </thead>
    <tbody>
    {% for employee in employees %}
    <tr {% if employee.termination_date %}style="background-color: #fff5f5;"{% endif %}>
      <td>
        <a href="{% url 'employees:employee_detail' employee.pk %}" style="font-weight: bold; color: var(--primary-color);">
            {{ employee.last_name }} {{ employee.first_name }} {{ employee.middle_name }}
        </a>
        {% if employee.is_safety_committee_member %}
        <br><span style="font-size: 0.8em; color: #d35400;">‚òÖ –ö–æ–º–∏—Å—Å–∏—è –ø–æ –û–¢</span>
        {% endif %}
      </td>
      <td>
          <div>{{ employee.position }}</div>
          <div style="font-size: 0.85em; color: #666;">{{ employee.department|default:"-" }}</div>
      </td>

      <td>
        {% if employee.termination_date %}
            <span class="badge badge-danger">–£–≤–æ–ª–µ–Ω</span>
        {% elif employee.on_parental_leave %}
            <span class="badge badge-info">–í –¥–µ–∫—Ä–µ—Ç–µ</span>
        {% else %}
            <span class="badge badge-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
        {% endif %}
      </td>
      <td>
        <a href="{% url 'employees:employee_update' employee.pk %}">–†–µ–¥.</a>
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div style="text-align: center; padding: 40px; color: #777;">
      <p>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞.</p>
  </div>
  {% endif %}
</section>
{% endblock %}