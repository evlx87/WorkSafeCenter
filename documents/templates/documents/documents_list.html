{% extends 'base.html' %}
{% block title %}
WorkSafeCenter - Документы
{% endblock %}
{% block content %}
<section>
  <h2>Список документов</h2>
  <a href="{% url 'documents:document_create' %}" class="button">Загрузить документ</a>
  <br><br>
  <form method="get" action="{% url 'documents:documents_list' %}" style="margin-bottom: 20px;">
    <div style="display: flex; gap: 15px; align-items: center;">
      <input
              type="text"
              name="search_query"
              placeholder="Поиск по названию..."
              value="{{ search_query }}"
      >
      <select name="doc_type">
        <option value="">Все типы</option>
        {% for value, name in doc_types %}
        <option
                value="{{ value }}"
                {% if value == selected_doc_type %}selected{% endif %}
        >
        {{ name }}
        </option>
        {% endfor %}
      </select>
      <button type="submit">Найти</button>
      <a href="{% url 'documents:documents_list' %}">Сбросить</a>
    </div>
  </form>
  {% if documents %}
  <table border="1" cellpadding="5" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>Название</th>
        <th>Тип</th>
        <th>Сотрудник</th>
        <th>Дата загрузки</th>
        <th>Файл</th>
        <th>Действия</th>
      </tr>
    </thead>
    <tbody>
      {% for document in documents %}
      <tr>
        <td>{{ document.title }}</td>
        <td>{{ document.get_document_type_display }}</td>
        <td>{{ document.employee|default:"Общий" }}</td>
        <td>{{ document.upload_date|date:"d.m.Y" }}</td>
        <td>
          <a href="{{ document.file.url }}" target="_blank">Открыть</a>
        </td>
        <td>
          <a href="{% url 'documents:document_delete' document.pk %}">Удалить</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>Документы не найдены.</p>
  {% endif %}
</section>
{% endblock %}