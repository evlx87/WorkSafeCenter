{% extends 'base.html' %}
{% block title %}WorkSafeCenter - –û–±—É—á–µ–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∏{% endblock %}

{% block content %}
<section style="background: transparent; box-shadow: none; padding: 0;">

    <div class="section-header" style="border-bottom: none; margin-bottom: 20px;">
        <h2>üìö –ü—Ä–æ–≥—Ä–∞–º–º—ã –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∏</h2>
        <a href="{% url 'safety_trainings_create_program' %}" class="button"> + –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É</a>
    </div>

    <div class="summary-grid">
        <div class="summary-card summary-primary">
            <h4>–í—Å–µ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–µ–µ—Å—Ç—Ä–µ</h4>
            <p class="value">{{ total_programs_count|default:"-" }}</p>
        </div>
        <div class="summary-card summary-accent">
            <h4>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –±–∞–∑–µ</h4>
            <p class="value">{{ total_employees_count|default:"-" }}</p>
        </div>
        <div class="summary-card summary-danger">
            <h4>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –ø—Ä–æ—Å—Ä–æ—á–∫–∞–º–∏</h4>
            <p class="value">{{ overdue_employees_count|default:"-" }}</p>
        </div>
    </div>
</section>

<section>
    <h3 style="margin-top: 0;">–†–µ–µ—Å—Ç—Ä —É—á–µ–±–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º</h3>

    <form method="get" action="{% url 'safety_trainings_list' %}" class="filter-toolbar">
        <input
            type="text"
            name="search_query"
            placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º—ã..."
            value="{{ search_query }}"
        >
        <select name="training_type">
            <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
            {% for value, label in type_choices %}
            <option value="{{ value }}" {% if value|stringformat:"s" == selected_type %}selected{% endif %}>
                {{ label }}
            </option>
            {% endfor %}
        </select>

        <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        <a href="{% url 'safety_trainings_list' %}" style="color: #666; margin-left: 10px; font-size: 0.9em;">–°–±—Ä–æ—Å–∏—Ç—å</a>
    </form>

    {% if programs %}
    <table>
        <thead>
        <tr>
            <th>–ü—Ä–æ–≥—Ä–∞–º–º–∞</th>
            <th>–¢–∏–ø / –ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
            <th>–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å</th>
            <th>–ß–∞—Å—ã</th>
            <th style="width: 150px;">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        {% for program in programs %}
        <tr>
            <td>
                <a href="{% url 'safety_trainings_detail' program.pk %}" style="font-weight: bold; color: var(--primary-color);">
                    {{ program.name }}
                </a>
                {% if program.is_mandatory %}
                    <span class="badge badge-primary" style="background-color: #3498db; color: white; margin-left: 10px;">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</span>
                {% endif %}
            </td>
            <td>
                {{ program.get_training_type_display }}
                <div style="font-size: 0.85em; color: #666; margin-top: 3px;">
                    –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ program.get_category_display|default:"–û–±—â–∞—è" }}
                </div>
            </td>
            <td>
                {% if program.frequency_months > 0 %}
                    –†–∞–∑ –≤ {{ program.frequency_months }} –º–µ—Å.
                {% else %}
                    –ë–µ—Å—Å—Ä–æ—á–Ω–æ
                {% endif %}
            </td>
            <td>{{ program.hours }} —á.</td>
            <td>
                <a href="{% url 'safety_trainings_update_program' program.pk %}" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
                <a href="{% url 'safety_trainings_journal' program.pk %}" title="–ñ—É—Ä–Ω–∞–ª" style="margin-left: 10px; color: var(--accent-color);">üìã</a>
                <a href="{% url 'safety_trainings_delete_program' program.pk %}" title="–£–¥–∞–ª–∏—Ç—å" style="color: var(--danger-color); margin-left: 10px;">üóëÔ∏è</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="text-align: center; padding: 30px; color: #777;">–í —Ä–µ–µ—Å—Ç—Ä–µ –Ω–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º –æ–±—É—á–µ–Ω–∏—è.</p>
    {% endif %}
</section>

<section>
    <div class="section-header">
        <h3>–ñ—É—Ä–Ω–∞–ª –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π</h3>
        <a href="{% url 'safety_trainings_all_journal' %}" class="button" style="background-color: #7f8c8d;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—Å—å –∂—É—Ä–Ω–∞–ª</a>
    </div>
    <p style="color: #666;">–ó–¥–µ—Å—å –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∏ –∏ –æ–±—É—á–µ–Ω–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã.</p>
</section>
{% endblock %}